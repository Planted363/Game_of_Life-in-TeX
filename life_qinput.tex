%% ## The actual placement work after xinput. ##

\def\lc@place@init{%
    \lb@init
    \ifnum\lb@size@x<\l@attrib@x
        \errmessage{Sorry, your pattern is too large.}%
    \else
        \ifnum\lb@size@y<\l@attrib@y
            \errmessage{Sorry, your pattern is too large.}%
        \fi
    \fi
    %% We choose the starting left corner.
    %% x start = ( \lb@size@x - \l@attrib@x ) / 2
    \l@tmpx=\lb@size@x
    \advance\l@tmpx -\l@attrib@x
    \divide\l@tmpx2
    %% y start = ( \lb@size@y - \l@attrib@y ) / 2
    \l@tmpy=\lb@size@y
    \advance\l@tmpy -\l@attrib@y
    \divide\l@tmpy2
    \global\i=\l@tmpy\global\j=\l@tmpx
    \global\l@tmpy=\i\global\l@tmpx=\j
}

\def\lc@place@dead{%
    \global\advance\j1\relax
}
\def\lc@place@alive{%
    \global\expandafter\let\csname lc@\the\i;\the\j\endcsname\lc@alive
    \global\advance\j1\relax
}
\def\lc@place@break{%
    \endgraf
    \global\j=\l@tmpx\global\advance\i1\relax
}

\def\lb@forw@once{\vfill\eject\advance\lb@iter1\l@input@header@make\lb@tick\lb@print@next}
\let\lb@forw@once@\lb@forw@once
\def\gameforw#1{%
    \h=1\begingroup
        \aftergroup\def\aftergroup\next\aftergroup{%
        \loop\aftergroup\lb@forw@once\advance\h1\ifnum\h<#1\repeat
        \aftergroup}%
    \endgroup\next
}
